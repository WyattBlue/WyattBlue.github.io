<!doctype html>
<!-- version 4 -->
<html>
<head>
<title>Web Editor</title>
<meta
      name='viewport'
      content='width=device-width,initial-scale=1.0, maximum-scale=1.0,user-scalable=0'/>
<style>
	body {
		background-color: #010;
		overflow:hidden;
	}
	textarea {
		font-family:monospace;
		font-size:30px;
		background-color: #111C1A;
		color: #DDD;
		border:0px;
		margin:0px;
		padding:0px;
		resize:none;
		width:44%;
		padding:3%:
	}
	#edit {
	  box-sizing: border-box;
	  border: 3px solid #ccc;
	  -webkit-transition: 0.5s;
	  transition: 0.5s;
	  outline: none;
</style>
</head>
<body>
	<textarea id="edit" autocapitalize="off">please enable javascript</textarea>
	<textarea id="result" readonly></textarea>
<script>
!function(){


function getCookie(cname) {
  let name = cname +"=";let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i=0;i<ca.length;i++) {
    let c =ca[i];
    while(c.charAt(0)==' '){c = c.substring(1);}
    if(c.indexOf(name) == 0){
      return c.substring(name.length, c.length);
    }
  }
  return"";}
let editCookie = document.getElementById('edit');
try {
	if(getCookie('text')==''){
		editCookie.value="console.log('hello');\nconsole.log('world');";
	}else{
		editCookie.value =(getCookie("text").split("<br>").join('\n')).split("<sc>").join(";").split("<eq>").join("=");
	}
}
catch {
	editCookie.value="console.log('hello');\nconsole.log('world');";
}

!function main(){
let w = window.innerWidth;
let h = window.innerHeight;
let edit = document.getElementById('edit');
let rslt = document.getElementById('result');
edit.id="edit";
	
edit.style.height = h-20 + "px";
rslt.style.height = h-20 + "px";

edit.value = edit.value.split('“').join('"');
edit.value = edit.value.split('”').join('"');	
edit.value = edit.value.split("‘").join("'");
edit.value = edit.value.split("’").join("'");
edit.value = edit.value.split("’").join("'");

let fixed = edit.value;
fixed = fixed.split("console.log").join("INTERNALcon.push");
fixed = fixed.split("console.dir").join("INTERNALcon.push");
fixed = fixed.split("alert(").join("INTERNALcon.push(");
fixed = fixed.split("this.").join("");
fixed = fixed.split(".document").join("");
fixed = fixed.split("this)").join("");

let string;
rslt.value = inter(fixed,edit.value);
let editValueFormatted = ((edit.value).split("\n").join("<br>")).split(";").join("<sc>").split("=").join("<eq>");
document.cookie = "text="+editValueFormatted;
setTimeout(main,30);

}();

function inter(INTERNALedit,org){
	let INTERNALcon = [];
	let document;
	try {
		if(INTERNALedit.includes('while(true){') && !INTERNALedit.includes('break;')){
			return org+"\n\nNever Ending Loop Detected";
		}
		if(INTERNALedit.includes('while(1){') && !INTERNALedit.includes('break;')){
			return org+"\n\nNever Ending Loop Detected";
		}
		eval(INTERNALedit);
		if(INTERNALcon[0]==undefined){
			return org+"\n\n> ";
		} else {
			string = org+"\n";
			for(let i =0;i<INTERNALcon.length;i++){
				string+="\n > "+INTERNALcon[i];
			}
			return string;
		}
	}
	catch(error) {
		return org+"\n\n"+error;
	}
}

}();
</script>
</body>
</html>
