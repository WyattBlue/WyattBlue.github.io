<!doctype html>
<!-- version 2 -->
<html>
<head>
<title>Web Editor</title>
<style>
	body {
		background-color: #010;
		overflow:hidden;
	}
	textarea {
		font-family:monospace;
		font-size:30px;
		background-color: #121;
		color: #DDD;
		border:0px;
		resize:none;
	}
</style>
</head>
<body>
	<textarea id="edit" autocapitalize="off">please enable javascript</textarea>
	<textarea id="result" readonly></textarea>
<script>
!function(){


function getCookie(cname) {
  let name = cname +"=";let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i=0;i<ca.length;i++) {
    let c =ca[i];
    while(c.charAt(0)==' '){c = c.substring(1);}
    if(c.indexOf(name) == 0){
      return c.substring(name.length, c.length);
    }
  }
  return"";}
let editCookie = document.getElementById('edit');
try {
	if(getCookie('text')==''){
		editCookie.value="console.log('hello');\nconsole.log('world');";
	}else{
		editCookie.value =(getCookie("text").split("<br>").join('\n')).split("@").join(";");
	}
}
catch {
	editCookie.value="console.log('hello');\nconsole.log('world');";
}

!function main(){
let w = window.innerWidth;
let h = window.innerHeight;
let edit = document.getElementById('edit');
let rslt = document.getElementById('result');
edit.id="edit";
edit.style.width = w/2-20 + "px";
edit.style.height = h-20 + "px";
rslt.style.width = w/2-20 + "px";
rslt.style.height = h-20 + "px";

let fixed = edit.value;
fixed = fixed.split("console.log").join("INTERNALcon.push");
fixed = fixed.split("alert(").join("INTERNALcon.push(");
fixed = fixed.split("document.").join("");

let string;
rslt.value = inter(fixed,edit.value);
let editValueFormatted = ((edit.value).split("\n").join("<br>")).split(";").join("@");
document.cookie = "text="+editValueFormatted;
setTimeout(main,30);

}();

function inter(INTERNALedit,org){
	let INTERNALcon = [];
	try {
		if(INTERNALedit.includes('while(true){') && !INTERNALedit.includes('break;')){
			return org+"\n\nNever Ending Loop Detected";
		}
		if(INTERNALedit.includes('while(1){') && !INTERNALedit.includes('break;')){
			return org+"\n\nNever Ending Loop Detected";
		}
		eval(INTERNALedit);
		if(INTERNALcon[0]==undefined){
			return org+"\n\n> ";
		} else {
			string = org+"\n";
			for(let i =0;i<INTERNALcon.length;i++){
				string+="\n > "+INTERNALcon[i];
			}
			return string;
		}
	}
	catch(error) {
		return org+"\n\n"+error;
	}
}

}();
</script>
</body>
</html>
