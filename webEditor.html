<!doctype html>
<html>
<head>
<title>Web Editor</title>
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
<meta name='apple-mobile-web-app-capable' content='yes' />
<style>
	body {
		background-color: #010;
		overflow:hidden;
		touch-action:none;
	}
	textarea {
		font-family:monospace;
		background-color: #111C1A;
		color: #DDD;
		resize:none;
		border:0px;
		width:48%;
		margin-top:1%;
		tab-size:4;
		-moz-tab-size:4;
		-o-tab-size: 4;
	}
	#edit {
		float:left;
	}
	#rslt {
		float:right;
		overflow-x:hidden;
	}
	#gear{
		float:left;
		position:absolute;
	}
	#gear:hover{
		background-color:blue;
		transform:rotate(12deg);
	}
	
</style>
</head>
<body>

<textarea id="edit" autocapitalize="off" autocomplete="off" placeholder='console.log("Hello World");' spellcheck="false" >please enable javascript</textarea>
<textarea id="rslt" readonly="readonly" placeholder='JS Web Editor 
by Wyatt Blue 

enter Javascript (JS) code on the left textbox.' 
spellcheck="false"></textarea>
<div id="gear">
	<span>⚙</span>
</div>
<script>

!function(){


function getCookie(cname) {
  let name=cname+"=";
  let decodedCookie=decodeURIComponent(document.cookie);
  let ca=decodedCookie.split(';');
  for(let i=0;i<ca.length;i++){
    let c=ca[i];
    while(c.charAt(0)==' '){c=c.substring(1);}
    if(c.indexOf(name)==0)
    	return c.substring(name.length,c.length);
  }return"";}

let edit = document.getElementById('edit');
let rslt = document.getElementById('rslt');
let gear = document.getElementById('gear');
gear.style.position="absolute";
let execute=false;
edit.onkeydown=function(){
	if(event.keyCode===9){
		let v=this.value,s=this.selectionStart,e=this.selectionEnd;
		this.value=v.substring(0,s)+'\t'+v.substring(e);
		this.selectionStart=this.selectionEnd=s+1;
		return false;
	}
	execute=true;
}

let font=30;
let gearAngle = 0;
try {
	edit.value=getCookie("text").split("<br>").join('\n').split("<sc>").join(";").split("<eq>").join("=").split("<tab>").join("\t");
}
catch(error) {
	edit.value='';
}

!function main(){
let w = window.innerWidth;
let h = window.innerHeight;

	
edit.style.height = h-120 + "px";
edit.style.marginLeft = w*0.01 + "px";
edit.style.fontSize=(w<=470?font/2:font) + "px";
rslt.style.height = h-120 + "px";
rslt.style.marginRight = w*0.01 + "px";
rslt.style.fontSize=(w<=470?font/2:font) + "px";
gear.style.fontSize=(w<=470?50:50) + "px";
gear.style.marginLeft = w*0.01 + "px";
gear.style.marginTop = (h*0.88)+"px";
gear.style.transform="rotate("+gearAngle+"deg)";
if(w<=470){
	edit.style.width=w*.46 - 13 +"px";
	rslt.style.width=w*.46 - 13 +"px";
}else{
	edit.style.width="48%";
	rslt.style.width="48%";
}

edit.value = edit.value.split('“').join('"');
edit.value = edit.value.split('”').join('"');	
edit.value = edit.value.split("‘").join("'");
edit.value = edit.value.split("’").join("'");

let fixed = edit.value;
fixed = fixed.split("console.log").join("INTERNALcon.push");
fixed = fixed.split("console.dir").join("INTERNALcon.push");
fixed = fixed.split("this.").join("");
fixed = fixed.split(".document").join("");
fixed = fixed.split("this)").join("");


if(edit.value!=""){
	if(execute){
		rslt.value = edit.value + inter(fixed);
		execute=false;
	}
}else{
	rslt.value="";
}

let editValueFormatted = (edit.value).split("\n").join("<br>").split(";").join("<sc>").split("=").join("<eq>").split("\t").join("<tab>");
document.cookie = "text="+editValueFormatted;
setTimeout(main,30);

}();

}();

function inter(INTERNALedit){
	INTERNALcon = [];
	try {
		if(INTERNALedit.includes('while(true){') && !INTERNALedit.includes('break;')){
			return edit.value+"\n\nInfinite Loop Detected";
		}
		if(INTERNALedit.includes('while(1){') && !INTERNALedit.includes('break;')){
			return edit.value+"\n\nInfinite Loop Detected";
		}
		if(INTERNALedit.includes('for(;;){') && !INTERNALedit.includes('break;')){
			return edit.value+"\n\nInfinite Loop Detected";
		}

		let document;
		let console;
		let edit;
		let rslt;
		let gear;

		eval(INTERNALedit);

		let INTERNALstring = "";
		for(let i=0;i<INTERNALcon.length;i++){
			INTERNALstring+="\n > "+INTERNALcon[i];
		}
		return "\n"+INTERNALstring;
	}
	catch(error) {
		return "\n\n"+error;
	}
}



</script>
</body>
</html>
